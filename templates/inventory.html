<!DOCTYPE html>
<html>
<head>
    <title>Your Inventory</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="grocery-tracker">
        Grocery Tracker - Manage your shopping list!
    </div>

    <h2>Your Inventory</h2>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash">
          {% for message in messages %}
            <p>{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <form method="POST">
        <input name="product_name" placeholder="Product Name" required>
        <input name="quantity" type="number" placeholder="Quantity" required>
        <input name="threshold" type="number" placeholder="Restock Threshold" required>
        <button type="submit">Add Product</button>
    </form>

    <table id="inventoryTable">
        <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Threshold</th>
            <th>Last Updated</th>
            <th>Action</th>
        </tr>

        {% for item in items %}
        <tr>
            <td>{{ item[1] }}</td>

            <!-- Quantity -->
            <td style="text-align: center;">
                <div style="display: flex; align-items: center; justify-content: center;">
                    <span>{{ item[2] }}</span>
                    <div style="display: flex; flex-direction: column; margin-left: 4px;">
                        <form method="POST" action="/update_quantity" style="margin: 0;">
                            <input type="hidden" name="product_id" value="{{ item[0] }}">
                            <input type="hidden" name="direction" value="up">
                            <button type="submit" style="background: none; border: none; padding: 2px; border-radius: 50%; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#e0e0e0'" onmouseout="this.style.backgroundColor='transparent'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="gray" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 14l5-5 5 5H7z"/>
                                </svg>
                            </button>
                        </form>
                        <form method="POST" action="/update_quantity" style="margin: 0;">
                            <input type="hidden" name="product_id" value="{{ item[0] }}">
                            <input type="hidden" name="direction" value="down">
                            <button type="submit" style="background: none; border: none; padding: 2px; border-radius: 50%; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#e0e0e0'" onmouseout="this.style.backgroundColor='transparent'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="gray" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 10l5 5 5-5H7z"/>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </td>

            <!-- Threshold -->
            <td style="text-align: center;">
                <div style="display: flex; align-items: center; justify-content: center;">
                    <span>{{ item[3] }}</span>
                    <div style="display: flex; flex-direction: column; margin-left: 4px;">
                        <form method="POST" action="/update_threshold" style="margin: 0;">
                            <input type="hidden" name="product_id" value="{{ item[0] }}">
                            <input type="hidden" name="direction" value="up">
                            <button type="submit" style="background: none; border: none; padding: 2px; border-radius: 50%; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#e0e0e0'" onmouseout="this.style.backgroundColor='transparent'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="gray" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 14l5-5 5 5H7z"/>
                                </svg>
                            </button>
                        </form>
                        <form method="POST" action="/update_threshold" style="margin: 0;">
                            <input type="hidden" name="product_id" value="{{ item[0] }}">
                            <input type="hidden" name="direction" value="down">
                            <button type="submit" style="background: none; border: none; padding: 2px; border-radius: 50%; transition: background-color 0.2s;" onmouseover="this.style.backgroundColor='#e0e0e0'" onmouseout="this.style.backgroundColor='transparent'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="gray" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 10l5 5 5-5H7z"/>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </td>

            <td>{{ item[4] }}</td>
            <td>
                <form method="POST" action="/delete" style="margin: 0;">
                    <input type="hidden" name="product_id" value="{{ item[0] }}">
                    <button type="submit">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}

        <tr>
            <th colspan="5" style="background-color: #e0e0e0; text-align: center;">Product Totals</th>
        </tr>

        {% for name, total in totals.items() %}
        <tr style="color: gray; font-style: italic;">
            <td>{{ name }}</td>
            <td>{{ total }}</td>
            <td>--</td>
            <td>--</td>
            <td>--</td>
        </tr>
        {% endfor %}
    </table>

    <p>
        <a href="/upload">Upload Sales</a> |
        <a href="/restock">Restock</a> |
        <a href="/logout">Logout</a>
    </p>
</body>
</html>
